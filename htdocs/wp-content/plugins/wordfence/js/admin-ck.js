if(!window.wordfenceAdmin){window.wordfenceAdmin={loading16:'<div class="wfLoading16"></div>',loadingCount:0,dbCheckTables:[],dbCheckCount_ok:0,dbCheckCount_skipped:0,dbCheckCount_errors:0,issues:[],ignoreData:!1,iconErrorMsgs:[],scanIDLoaded:0,colorboxQueue:[],colorboxOpen:!1,mode:"",visibleIssuesPanel:"new",preFirstScanMsgsLoaded:!1,newestActivityTime:0,elementGeneratorIter:1,reloadConfigPage:!1,nonce:!1,tickerUpdatePending:!1,activityLogUpdatePending:!1,lastALogCtime:0,activityQueue:[],totalActAdded:0,maxActivityLogItems:1e3,scanReqAnimation:!1,debugOn:!1,blockedCountriesPending:[],ownCountry:"",schedStartHour:!1,currentPointer:!1,countryMap:!1,countryCodesToSave:"",init:function(){this.nonce=WordfenceAdminVars.firstNonce;this.debugOn=WordfenceAdminVars.debugOn=="1"?!0:!1;this.tourClosed=WordfenceAdminVars.tourClosed=="1"?!0:!1;var e=!1;if(jQuery("#wordfenceMode_scan").length>0){this.mode="scan";jQuery("#wfALogViewLink").prop("href",WordfenceAdminVars.siteBaseURL+"?_wfsf=viewActivityLog&nonce="+this.nonce);jQuery("#consoleActivity").scrollTop(jQuery("#consoleActivity").prop("scrollHeight"));jQuery("#consoleScan").scrollTop(jQuery("#consoleScan").prop("scrollHeight"));this.noScanHTML=jQuery("#wfNoScanYetTmpl").tmpl().html();this.loadIssues();this.startActivityLogUpdates();this.tourClosed||this.scanTourStart()}else if(jQuery("#wordfenceMode_activity").length>0){this.mode="activity";this.activityMode="hit";e=!0;if(!this.tourClosed){var t=this;this.tour("wfWelcomeContent3","wfHeading","top","left","Learn about IP Blocking",function(){t.tourRedir("WordfenceBlockedIPs")})}}else if(jQuery("#wordfenceMode_options").length>0){this.mode="options";jQuery(".wfConfigElem").change(function(){jQuery("#securityLevel").val("CUSTOM")});this.updateTicker(!0);e=!0;if(!this.tourClosed){var t=this;this.tour("wfContentBasicOptions","wfMarkerBasicOptions","top","left","Learn about Live Traffic Options",function(){t.tour("wfContentLiveTrafficOptions","wfMarkerLiveTrafficOptions","bottom","left","Learn about Scanning Options",function(){t.tour("wfContentScansToInclude","wfMarkerScansToInclude","bottom","left","Learn about Firewall Rules",function(){t.tour("wfContentFirewallRules","wfMarkerFirewallRules","bottom","left","Learn about Login Security",function(){t.tour("wfContentLoginSecurity","wfMarkerLoginSecurity","bottom","left","Learn about Other Options",function(){t.tour("wfContentOtherOptions","wfMarkerOtherOptions","bottom","left",!1,!1)})})})})})}}else if(jQuery("#wordfenceMode_blockedIPs").length>0){this.mode="blocked";this.staticTabChanged();this.updateTicker(!0);e=!0;if(!this.tourClosed){var t=this;this.tour("wfWelcomeContent4","wfHeading","top","left","Learn about Cellphone Sign-in",function(){t.tourRedir("WordfenceTwoFactor")})}}else if(jQuery("#wordfenceMode_twoFactor").length>0){this.mode="twoFactor";e=!1;if(!this.tourClosed){var t=this;this.tour("wfWelcomeTwoFactor","wfHeading","top","left","Learn how to Block Countries",function(){t.tourRedir("WordfenceCountryBlocking")})}this.loadTwoFactor()}else if(jQuery("#wordfenceMode_countryBlocking").length>0){this.mode="countryBlocking";e=!1;if(!this.tourClosed){var t=this;this.tour("wfWelcomeContentCntBlk","wfHeading","top","left","Learn how to Schedule Scans",function(){t.tourRedir("WordfenceScanSchedule")})}}else if(jQuery("#wordfenceMode_rangeBlocking").length>0){this.mode="rangeBlocking";e=!1;if(!this.tourClosed){var t=this;this.tour("wfWelcomeContentRangeBlocking","wfHeading","top","left","Learn how to Customize Wordfence",function(){t.tourRedir("WordfenceSecOpt")})}this.calcRangeTotal();this.loadBlockRanges()}else if(jQuery("#wordfenceMode_whois").length>0){this.mode="whois";e=!1;if(!this.tourClosed){var t=this;this.tour("wfWelcomeContentWhois","wfHeading","top","left","Learn how to use Advanced Blocking",function(){t.tourRedir("WordfenceRangeBlocking")})}this.calcRangeTotal();this.loadBlockRanges()}else if(jQuery("#wordfenceMode_scanScheduling").length>0){this.mode="scanScheduling";e=!1;this.sched_modeChange();if(!this.tourClosed){var t=this;this.tour("wfWelcomeContentScanSched","wfHeading","top","left","Learn about WHOIS",function(){t.tourRedir("WordfenceWhois")})}}else this.mode=!1;if(this.mode){var t=this;e&&(this.liveInt=setInterval(function(){t.updateTicker()},WordfenceAdminVars.actUpdateInterval));jQuery(document).bind("cbox_closed",function(){t.colorboxIsOpen=!1;t.colorboxServiceQueue()})}},scanTourStart:function(){var e=this;this.tour("wfWelcomeContent1","wfHeading","top","left","Continue the Tour",function(){e.tour("wfWelcomeContent2","wfHeading","top","left","Learn how to use Wordfence",function(){e.tour("wfWelcomeContent3","wfHeading","top","left","Learn about Live Traffic",function(){e.tourRedir("WordfenceActivity")})})})},tourRedir:function(e){window.location.href="admin.php?page="+e},tourFinish:function(){this.ajax("wordfence_tourClosed",{},function(e){})},downgradeLicense:function(){this.colorbox("400px","Confirm Downgrade",'Are you sure you want to downgrade your Wordfence Premium License? This will disable all Premium features and return you to the free version of Wordfence. <a href="https://www.wordfence.com/manage-wordfence-api-keys/" target="_blank">Click here to renew your paid membership</a> or click the button below to confirm you want to downgrade.<br /><br /><input type="button" value="Downgrade and disable Premium features" onclick="WFAD.downgradeLicenseConfirm();" /><br />')},downgradeLicenseConfirm:function(){jQuery.colorbox.close();this.ajax("wordfence_downgradeLicense",{},function(e){location.reload(!0)})},tour:function(e,t,n,r,i,s){var o=this;if(this.currentPointer){this.currentPointer.pointer("destroy");this.currentPointer=!1}var u={buttons:function(e,t){var n=jQuery('<div id="wfTourButCont"><a id="pointer-close" style="margin-left:5px" class="button-secondary">End the Tour</a></div><div><a id="wfRateLink" href="http://wordpress.org/extend/plugins/wordfence/" target="_blank" style="font-size: 10px; font-family: Verdana;">Help spread the word by rating us 5&#9733; on WordPress.org</a></div>');n.find("#pointer-close").bind("click.pointer",function(e){var n=e.srcElement?e.srcElement:e.target;if(n.id=="wfRateLink")return!0;o.tourFinish();t.element.pointer("close");return!1});return n},close:function(){},content:jQuery("#"+e).tmpl().html(),pointerWidth:400,position:{edge:n,align:r}};this.currentPointer=jQuery("#"+t).pointer(u).pointer("open");if(i&&s){jQuery("#pointer-close").after('<a id="pointer-primary" class="button-primary">'+i+"</a>");jQuery("#pointer-primary").click(s)}},startTourAgain:function(){this.ajax("wordfence_startTourAgain",{},function(e){});this.tourClosed=!1;this.scanTourStart()},showLoading:function(){this.loadingCount++;this.loadingCount==1&&jQuery('<div id="wordfenceWorking">Wordfence is working...</div>').appendTo("body")},removeLoading:function(){this.loadingCount--;this.loadingCount==0&&jQuery("#wordfenceWorking").remove()},startActivityLogUpdates:function(){var e=this;setInterval(function(){e.updateActivityLog()},parseInt(WordfenceAdminVars.actUpdateInterval))},updateActivityLog:function(){if(this.activityLogUpdatePending)return;this.activityLogUpdatePending=!0;var e=this;this.ajax("wordfence_activityLogUpdate",{lastctime:this.lastALogCtime},function(t){e.doneUpdateActivityLog(t)},function(){e.activityLogUpdatePending=!1},!0)},doneUpdateActivityLog:function(e){this.actNextUpdateAt=(new Date).getTime()+parseInt(WordfenceAdminVars.actUpdateInterval);if(e.ok&&e.items.length>0){this.activityQueue.push.apply(this.activityQueue,e.items);this.lastALogCtime=e.items[e.items.length-1].ctime;this.processActQueue(e.currentScanID)}this.activityLogUpdatePending=!1},processActQueue:function(e){if(this.activityQueue.length>0){this.addActItem(this.activityQueue.shift());this.totalActAdded++;if(this.totalActAdded>this.maxActivityLogItems){jQuery("#consoleActivity div:first").remove();this.totalActAdded--}var t=this.actNextUpdateAt-(new Date).getTime(),n=.05,r=0;while(this.activityQueue.length>0&&this.activityQueue.length/t>n){var i=this.activityQueue.shift();if(i){r++;this.addActItem(i)}}this.totalActAdded+=r;if(this.totalActAdded>this.maxActivityLogItems){jQuery("#consoleActivity div:lt("+r+")").remove();this.totalActAdded-=r}var s=100,o=s;if(t<1)o=s;else{o=Math.round(t/this.activityQueue.length);o<s&&(o=s)}var u=this;setTimeout(function(){u.processActQueue()},o)}jQuery("#consoleActivity").scrollTop(jQuery("#consoleActivity").prop("scrollHeight"))},processActArray:function(e){for(var t=0;t<e.length;t++)this.addActItem(e[t])},addActItem:function(e){if(!e)return;if(!e.msg)return;if(e.msg.indexOf("SUM_")==0){this.processSummaryLine(e);jQuery("#consoleSummary").scrollTop(jQuery("#consoleSummary").prop("scrollHeight"));jQuery("#wfStartingScan").addClass("wfSummaryOK").html("Done.")}else if(this.debugOn||e.level<4){var t='<div class="wfActivityLine';this.debugOn&&(t+=" wf"+e.type);t+='">['+e.date+"]&nbsp;"+e.msg+"</div>";jQuery("#consoleActivity").append(t);/Scan complete\./i.test(e.msg)&&this.loadIssues()}},processSummaryLine:function(e){if(e.msg.indexOf("SUM_START:")!=-1){var t=e.msg.replace("SUM_START:","");jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult"><div class="wfSummaryLoading"></div></div><div class="wfClear"></div>');summaryUpdated=!0}else if(e.msg.indexOf("SUM_ENDBAD")!=-1){var t=e.msg.replace("SUM_ENDBAD:","");jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryBad").html("Problems found.");summaryUpdated=!0}else if(e.msg.indexOf("SUM_ENDFAILED")!=-1){var t=e.msg.replace("SUM_ENDFAILED:","");jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryBad").html("Failed.");summaryUpdated=!0}else if(e.msg.indexOf("SUM_ENDOK")!=-1){var t=e.msg.replace("SUM_ENDOK:","");jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryOK").html("Secure.");summaryUpdated=!0}else if(e.msg.indexOf("SUM_ENDSUCCESS")!=-1){var t=e.msg.replace("SUM_ENDSUCCESS:","");jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryOK").html("Success.");summaryUpdated=!0}else if(e.msg.indexOf("SUM_ENDERR")!=-1){var t=e.msg.replace("SUM_ENDERR:","");jQuery('div.wfSummaryMsg:contains("'+t+'")').next().addClass("wfSummaryErr").html("An error occurred.");summaryUpdated=!0}else if(e.msg.indexOf("SUM_DISABLED:")!=-1){var t=e.msg.replace("SUM_DISABLED:","");jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult">Disabled [<a href="admin.php?page=WordfenceSecOpt">Visit Options to Enable</a>]</div><div class="wfClear"></div>');summaryUpdated=!0}else if(e.msg.indexOf("SUM_PAIDONLY:")!=-1){var t=e.msg.replace("SUM_PAIDONLY:","");jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult"><a href="https://www.wordfence.com/wordfence-signup/" target="_blank">Paid Members Only</a></div><div class="wfClear"></div>');summaryUpdated=!0}else if(e.msg.indexOf("SUM_FINAL:")!=-1){var t=e.msg.replace("SUM_FINAL:","");jQuery("#consoleSummary").append('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg wfSummaryFinal">'+t+'</div><div class="wfSummaryResult wfSummaryOK">Scan Complete.</div><div class="wfClear"></div>')}else if(e.msg.indexOf("SUM_PREP:")!=-1){var t=e.msg.replace("SUM_PREP:","");jQuery("#consoleSummary").empty().html('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult" id="wfStartingScan"><div class="wfSummaryLoading"></div></div><div class="wfClear"></div>')}else if(e.msg.indexOf("SUM_KILLED:")!=-1){var t=e.msg.replace("SUM_KILLED:","");jQuery("#consoleSummary").empty().html('<div class="wfSummaryLine"><div class="wfSummaryDate">['+e.date+']</div><div class="wfSummaryMsg">'+t+'</div><div class="wfSummaryResult wfSummaryOK">Scan Complete.</div><div class="wfClear"></div>')}},processActQueueItem:function(){var e=this.activityQueue.shift();if(e){jQuery("#consoleActivity").append('<div class="wfActivityLine wf'+e.type+'">['+e.date+"]&nbsp;"+e.msg+"</div>");this.totalActAdded++;if(this.totalActAdded>this.maxActivityLogItems){jQuery("#consoleActivity div:first").remove();this.totalActAdded--}e.msg=="Scan complete."&&this.loadIssues()}},updateTicker:function(e){if(!e&&this.tickerUpdatePending)return;this.tickerUpdatePending=!0;var t=this,n="",r="";if(this.mode=="activity"&&/^(?:404|hit|human|ruser|gCrawler|crawler|loginLogout)$/.test(this.activityMode)){n="logList_"+this.activityMode;r=this.newestActivityTime}this.ajax("wordfence_ticker",{alsoGet:n,otherParams:r},function(e){t.handleTickerReturn(e)},function(){t.tickerUpdatePending=!1},!0)},handleTickerReturn:function(e){this.tickerUpdatePending=!1;var t="",n=jQuery("#wfLiveStatus").text();e.msg?t=e.msg:t="Idle";t&&t!=n&&jQuery("#wfLiveStatus").hide().html(t).fadeIn(200);if(this.mode=="activity"){if(e.alsoGet!="logList_"+this.activityMode)return;e.events.length>0&&(this.newestActivityTime=e.events[0].ctime);var r=!1;jQuery("#wfActivity_"+this.activityMode+" .wfActEvent").length>0&&(r=!0);if(e.events.length>0){r||jQuery("#wfActivity_"+this.activityMode).empty();for(i=e.events.length-1;i>=0;i--){var s="#wfActEvent_"+e.events[i].id;if(jQuery(s).length<1){e.events[i].activityMode=this.activityMode;var o;this.activityMode=="loginLogout"?o=jQuery("#wfLoginLogoutEventTmpl").tmpl(e.events[i]):o=jQuery("#wfHitsEventTmpl").tmpl(e.events[i]);jQuery(o).find(".wfTimeAgo").data("wfctime",e.events[i].ctime);o.prependTo("#wfActivity_"+this.activityMode).fadeIn()}}this.reverseLookupIPs()}else r||jQuery("#wfActivity_"+this.activityMode).html("<div>No events to report yet.</div>");var u=this;jQuery(".wfTimeAgo").each(function(t,n){jQuery(n).html(u.makeTimeAgo(e.serverTime-jQuery(n).data("wfctime"))+" ago")})}},reverseLookupIPs:function(){var e=[];jQuery(".wfReverseLookup").each(function(t,n){var r=jQuery(n).text();if(/^\d+\.\d+\.\d+\.\d+$/.test(r)&&!jQuery(n).data("wfReverseDone")){jQuery(n).data("wfReverseDone",!0);e.push(jQuery(n).text())}});if(e.length<1)return;var t={},n=[];for(var r=0;r<e.length;r++)if(!t[e[r]]){t[e[r]]=!0;n.push(e[r])}this.ajax("wordfence_reverseLookup",{ips:n.join(",")},function(e){e.ok&&jQuery(".wfReverseLookup").each(function(t,n){var r=jQuery(n).text();for(ip in e.ips)r==ip&&(e.ips[ip]?jQuery(n).html("<strong>Hostname:</strong>&nbsp;"+e.ips[ip]):jQuery(n).html(""))})},!1,!1)},killScan:function(){var e=this;this.ajax("wordfence_killScan",{},function(t){t.ok?e.colorbox("400px","Kill requested","A termination request has been sent to any running scans."):e.colorbox("400px","Kill failed","We failed to send a termination request.")})},startScan:function(){var e=setInterval(function(){var e=jQuery("#wfStartScanButton1").prop("value");ch=e.charAt(e.length-1);ch=="/"?ch="-":ch=="-"?ch="\\":ch=="\\"?ch="|":ch=="|"?ch="/":ch="/";jQuery("#wfStartScanButton1,#wfStartScanButton2").prop("value","Requesting a New Scan "+ch)},100);setTimeout(function(t){clearInterval(e);jQuery("#wfStartScanButton1,#wfStartScanButton2").prop("value","Start a Wordfence Scan")},3e3);this.ajax("wordfence_scan",{},function(e){})},loadIssues:function(e){if(this.mode!="scan")return;var t=this;this.ajax("wordfence_loadIssues",{},function(n){t.displayIssues(n,e)})},sev2num:function(e){return/wfProbSev1/.test(e)?1:/wfProbSev2/.test(e)?2:0},displayIssues:function(e,t){var n=this;try{e.summary.lastScanCompleted=e.lastScanCompleted}catch(r){e.summary.lastScanCompleted="Never"}jQuery(".wfIssuesContainer").hide();for(issueStatus in e.issuesLists){var i="wfIssues_dataTable_"+issueStatus,s="wfIssuesTable_"+issueStatus;if(jQuery("#"+i).length<1)continue;if(e.issuesLists[issueStatus].length<1){issueStatus=="new"?e.lastScanCompleted=="ok"?jQuery("#"+i).html('<p style="font-size: 20px; color: #0A0;">Congratulations! You have no security issues on your site.</p>'):e.lastScanCompleted||jQuery("#"+i).html():jQuery("#"+i).html("<p>There are currently <strong>no issues</strong> being ignored on this site.</p>");continue}jQuery("#"+i).html('<table cellpadding="0" cellspacing="0" border="0" class="display" id="'+s+'"></table>');jQuery.fn.dataTableExt.oSort["severity-asc"]=function(e,t){t=WFAD.sev2num(t);e=WFAD.sev2num(e);return t<e?1:t>e?-1:0};jQuery.fn.dataTableExt.oSort["severity-desc"]=function(e,t){t=WFAD.sev2num(t);e=WFAD.sev2num(e);return t>e?1:t<e?-1:0};jQuery("#"+s).dataTable({bFilter:!1,bInfo:!1,bPaginate:!1,bLengthChange:!1,bAutoWidth:!1,aaData:e.issuesLists[issueStatus],aoColumns:[{sTitle:'<div class="th_wrapp">Severity</div>',sWidth:"128px",sClass:"center",sType:"severity",fnRender:function(e){var t="";t="wfProbSev"+e.aData.severity;return'<span class="'+t+'"></span>'}},{sTitle:'<div class="th_wrapp">Issue</div>',bSortable:!1,sWidth:"400px",sType:"html",fnRender:function(e){var t="issueTmpl_"+e.aData.type;return jQuery("#"+t).tmpl(e.aData).html()}}]})}t?jQuery("#wfIssues_"+this.visibleIssuesPanel).fadeIn(500,function(){t()}):jQuery("#wfIssues_"+this.visibleIssuesPanel).fadeIn(500);return!0},ajax:function(e,t,n,r,i){if(typeof t=="string"){t.length>0&&(t+="&");t+="action="+e+"&nonce="+this.nonce}else if(typeof t=="object"){t.action=e;t.nonce=this.nonce}r||(r=function(){});var s=this;i||this.showLoading();jQuery.ajax({type:"POST",url:WordfenceAdminVars.ajaxURL,dataType:"json",data:t,success:function(e){i||s.removeLoading();e&&e.nonce&&(s.nonce=e.nonce);e&&e.errorMsg&&s.colorbox("400px","An error occurred",e.errorMsg);n(e)},error:function(){i||s.removeLoading();r()}})},colorbox:function(e,t,n){this.colorboxQueue.push([e,t,n]);this.colorboxServiceQueue()},colorboxServiceQueue:function(){if(this.colorboxIsOpen)return;if(this.colorboxQueue.length<1)return;var e=this.colorboxQueue.shift();this.colorboxOpen(e[0],e[1],e[2])},colorboxOpen:function(e,t,n){this.colorboxIsOpen=!0;jQuery.colorbox({width:e,html:"<h3>"+t+"</h3><p>"+n+"</p>"})},scanRunningMsg:function(){this.colorbox("400px","A scan is running","A scan is currently in progress. Please wait until it finishes before starting another scan.")},errorMsg:function(e){this.colorbox("400px","An error occurred:",e)},bulkOperation:function(e){var t=this;if(e!="del"&&e!="repair")return;var n=jQuery("input.wf"+e+"Checkbox:checked").map(function(){return jQuery(this).val()}).get();if(n.length<1){this.colorbox("400px","No files were selected","You need to select files to perform a bulk operation. There is a checkbox in each issue that lets you select that file. You can then select a bulk operation and hit the button to perform that bulk operation.");return}e=="del"?this.colorbox("400px","Are you sure you want to delete?","Are you sure you want to delete a total of "+n.length+' files? Do not delete files on your system unless you\'re ABSOLUTELY sure you know what you\'re doing. If you delete the wrong file it could cause your WordPress website to stop functioning and you will probably have to restore from backups. If you\'re unsure, Cancel and work with your hosting provider to clean your system of infected files.<br /><br /><input type="button" value="Delete Files" onclick="WFAD.bulkOperationConfirmed(\''+e+'\');" />&nbsp;&nbsp;<input type="button" value="Cancel" onclick="jQuery.colorbox.close();" /><br />'):e=="repair"&&this.colorbox("400px","Are you sure you want to repair?","Are you sure you want to repair a total of "+n.length+' files? Do not repair files on your system unless you\'re sure you have reviewed the differences between the original file and your version of the file in the files you are repairing. If you repair a file that has been customized for your system by a developer or your hosting provider it may leave your system unusable. If you\'re unsure, Cancel and work with your hosting provider to clean your system of infected files.<br /><br /><input type="button" value="Repair Files" onclick="WFAD.bulkOperationConfirmed(\''+e+'\');" />&nbsp;&nbsp;<input type="button" value="Cancel" onclick="jQuery.colorbox.close();" /><br />')},bulkOperationConfirmed:function(e){jQuery.colorbox.close();var t=this;this.ajax("wordfence_bulkOperation",{op:e,ids:jQuery("input.wf"+e+"Checkbox:checked").map(function(){return jQuery(this).val()}).get()},function(e){t.doneBulkOperation(e)})},doneBulkOperation:function(e){var t=this;e.ok?this.loadIssues(function(){t.colorbox("400px",e.bulkHeading,e.bulkBody)}):this.loadIssues(function(){})},deleteFile:function(e){var t=this;this.ajax("wordfence_deleteFile",{issueID:e},function(e){t.doneDeleteFile(e)})},doneDeleteFile:function(e){var t=!1,n=this;e.ok?this.loadIssues(function(){n.colorbox("400px","Success deleting file","The file "+e.file+" was successfully deleted.")}):e.cerrorMsg&&this.loadIssues(function(){n.colorbox("400px","An error occurred",e.cerrorMsg)})},restoreFile:function(e){var t=this;this.ajax("wordfence_restoreFile",{issueID:e},function(e){t.doneRestoreFile(e)})},doneRestoreFile:function(e){var t=this;e.ok?this.loadIssues(function(){t.colorbox("400px","File restored OK","The file "+e.file+" was restored succesfully.")}):e.cerrorMsg&&this.loadIssues(function(){t.colorbox("400px","An error occurred",e.cerrorMsg)})},deleteIssue:function(e){var t=this;this.ajax("wordfence_deleteIssue",{id:e},function(e){t.loadIssues()})},updateIssueStatus:function(e,t){var n=this;this.ajax("wordfence_updateIssueStatus",{id:e,status:t},function(e){e.ok&&n.loadIssues()})},updateAllIssues:function(e){var t="Please confirm";if(e=="deleteIgnored")body="You have chosen to remove all ignored issues. Once these issues are removed they will be re-scanned by Wordfence and if they have not been fixed, they will appear in the 'new issues' list. Are you sure you want to do this?";else if(e=="deleteNew")body="You have chosen to mark all new issues as fixed. If you have not really fixed these issues, they will reappear in the new issues list on the next scan. If you have not fixed them and want them excluded from scans you should choose to 'ignore' them instead. Are you sure you want to mark all new issues as fixed?";else{if(e!="ignoreAllNew")return;body="You have chosen to ignore all new issues. That means they will be excluded from future scans. You should only do this if you're sure all new issues are not a problem. Are you sure you want to ignore all new issues?"}this.colorbox("450px",t,body+'<br /><br /><center><input type="button" name="but1" value="Cancel" onclick="jQuery.colorbox.close();" />&nbsp;&nbsp;&nbsp;<input type="button" name="but2" value="Yes I\'m sure" onclick="jQuery.colorbox.close(); WFAD.confirmUpdateAllIssues(\''+e+"');\" /><br />")},confirmUpdateAllIssues:function(e){var t=this;this.ajax("wordfence_updateAllIssues",{op:e},function(e){t.loadIssues()})},es:function(e){return e?e:""},noQuotes:function(e){return e.replace(/"/g,"&#34;").replace(/\'/g,"&#145;")},commify:function(e){return(""+e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},switchToLiveTab:function(e){jQuery(".wfTab1").removeClass("selected");jQuery(e).addClass("selected");jQuery(".wfDataPanel").hide();var t=this;jQuery("#wfActivity").fadeIn(function(){t.completeLiveTabSwitch()})},completeLiveTabSwitch:function(){this.ajax("wordfence_loadActivityLog",{},function(e){var t='<a href="#" class="wfALogMailLink" onclick="WFAD.emailActivityLog(); return false;"></a><a href="#" class="wfALogReloadLink" onclick="WFAD.reloadActivityData(); return false;"></a>';if(e.events&&e.events.length>0){jQuery("#wfActivity").empty();for(var n=0;n<e.events.length;n++){var r="0.0000";e.events[n+1]&&(r=(e.events[n].ctime-e.events[n+1].ctime).toFixed(4));var i="";e.events[n].type=="error"&&(i=' class="wfWarn" ');t+="<div "+i+'class="wfALogEntry"><span '+i+'class="wfALogTime">['+e.events[n].type+"&nbsp;:&nbsp;"+r+"&nbsp;:&nbsp;"+e.events[n].timeAgo+" ago]</span>&nbsp;"+e.events[n].msg+"</div>"}jQuery("#wfActivity").html(t)}else jQuery("#wfActivity").html("<p>&nbsp;&nbsp;No activity to report yet. Please complete your first scan.</p>")})},emailActivityLog:function(){this.colorbox("400px","Email Wordfence Activity Log","Enter the email address you would like to send the Wordfence activity log to. Note that the activity log may contain thousands of lines of data. This log is usually only sent to a member of the Wordfence support team. It also contains your PHP configuration from the phpinfo() function for diagnostic data.<br /><br /><input type='text' value='support@wordfence.com' size='20' id='wfALogRecip' /><input type='button' value='Send' onclick=\"WFAD.completeEmailActivityLog();\" /><input type='button' value='Cancel' onclick='jQuery.colorbox.close();' /><br /><br />")},completeEmailActivityLog:function(){jQuery.colorbox.close();var e=jQuery("#wfALogRecip").val();if(!/^[^@]+@[^@]+$/.test(e)){alert("Please enter a valid email address.");return}var t=this;this.ajax("wordfence_sendActivityLog",{email:jQuery("#wfALogRecip").val()},function(n){n.ok&&t.colorbox("400px","Activity Log Sent","Your Wordfence activity log was sent to "+e+"<br /><br /><input type='button' value='Close' onclick='jQuery.colorbox.close();' /><br /><br />")})},reloadActivityData:function(){jQuery("#wfActivity").html('<div class="wfLoadingWhite32"></div>');this.completeLiveTabSwitch()},switchToSummaryTab:function(e){jQuery(".wfTab1").removeClass("selected");jQuery(e).addClass("selected");jQuery(".wfDataPanel").hide();jQuery("#wfSummaryTables").fadeIn()},switchIssuesTab:function(e,t){jQuery(".wfTab2").removeClass("selected");jQuery(".wfIssuesContainer").hide();jQuery(e).addClass("selected");this.visibleIssuesPanel=t;jQuery("#wfIssues_"+t).fadeIn()},switchTab:function(e,t,n,r,i){jQuery("."+t).removeClass("selected");jQuery(e).addClass("selected");jQuery("."+n).hide().html('<div class="wfLoadingWhite32"></div>');var s=function(){};i&&(s=function(){i()});jQuery("#"+r).fadeIn(s)},activityTabChanged:function(){var e=jQuery(".wfDataPanel:visible")[0].id.replace("wfActivity_","");if(!e)return;this.activityMode=e;this.reloadActivities()},reloadActivities:function(){jQuery("#wfActivity_"+this.activityMode).html('<div class="wfLoadingWhite32"></div>');this.newestActivityTime=0;this.updateTicker(!0)},staticTabChanged:function(){var e=jQuery(".wfDataPanel:visible")[0].id.replace("wfActivity_","");if(!e)return;this.activityMode=e;var t=this;this.ajax("wordfence_loadStaticPanel",{mode:this.activityMode},function(e){t.completeLoadStaticPanel(e)})},completeLoadStaticPanel:function(e){var t="#wfActivity_"+this.activityMode;jQuery(t).empty();if(e.results&&e.results.length>0){var n;if(this.activityMode=="topScanners"||this.activityMode=="topLeechers")n="#wfLeechersTmpl";else if(this.activityMode=="blockedIPs")n="#wfBlockedIPsTmpl";else if(this.activityMode=="lockedOutIPs")n="#wfLockedOutIPsTmpl";else{if(this.activityMode!="throttledIPs")return;n="#wfThrottledIPsTmpl"}jQuery(n).tmpl(e).prependTo(t);this.reverseLookupIPs()}else if(this.activityMode=="topScanners"||this.activityMode=="topLeechers")jQuery(t).html("No site hits have been logged yet. Check back soon.");else if(this.activityMode=="blockedIPs")jQuery(t).html("No IP addresses have been blocked yet. If you manually block an IP address or if Wordfence automatically blocks one, it will appear here.");else if(this.activityMode=="lockedOutIPs")jQuery(t).html("No IP addresses have been locked out from signing in or using the password recovery system.");else{if(this.activityMode!="throttledIPs")return;jQuery(t).html("No IP addresses have been throttled yet. If an IP address accesses the site too quickly and breaks one of the Wordfence rules, it will appear here.")}},ucfirst:function(e){e=""+e;return e.charAt(0).toUpperCase()+e.slice(1)},makeIPTrafLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=IPTraf&nonce="+this.nonce+"&IP="+encodeURIComponent(e)},makeDiffLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=diff&nonce="+this.nonce+"&file="+encodeURIComponent(this.es(e.file))+"&cType="+encodeURIComponent(this.es(e.cType))+"&cKey="+encodeURIComponent(this.es(e.cKey))+"&cName="+encodeURIComponent(this.es(e.cName))+"&cVersion="+encodeURIComponent(this.es(e.cVersion))},makeViewFileLink:function(e){return WordfenceAdminVars.siteBaseURL+"?_wfsf=view&nonce="+this.nonce+"&file="+encodeURIComponent(e)},makeTimeAgo:function(e){var t=Math.floor(e/2592e3),n=Math.floor(e/86400),r=Math.floor(e/3600),i=Math.floor(e/60);if(t>0){n-=t*30;return this.pluralize(t,"month",n,"day")}if(n>0){r-=n*24;return this.pluralize(n,"day",r,"hour")}if(r>0){i-=r*60;return this.pluralize(r,"hour",i,"min")}return i>0?this.pluralize(i,"minute"):Math.round(e)+" seconds"},pluralize:function(e,t,n,r){e!=1&&(t+="s");n!=1&&(r+="s");return e&&n?e+" "+t+" "+n+" "+r:e+" "+t},calcRangeTotal:function(){var e=jQuery("#ipRange").val();if(!e)return;e=e.replace(/ /g,"");if(e&&/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\s*\-\s*\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(e)){var t=e.split("-"),n=this.inet_aton(t[1])-this.inet_aton(t[0])+1;if(n<1){jQuery("#wfShowRangeTotal").html('<span style="color: #F00;">Invalid. Starting IP is greater than ending IP.</span>');return}jQuery("#wfShowRangeTotal").html('<span style="color: #0A0;">Valid: '+n+" addresses in range.</span>")}else jQuery("#wfShowRangeTotal").empty()},loadBlockRanges:function(){var e=this;this.ajax("wordfence_loadBlockRanges",{},function(t){e.completeLoadBlockRanges(t)})},completeLoadBlockRanges:function(e){jQuery("#currentBlocks").empty();e.results&&e.results.length>0?jQuery("#wfBlockedRangesTmpl").tmpl(e).prependTo("#currentBlocks"):jQuery("#currentBlocks").html("You have not blocked any IP ranges or other patterns yet.")},whois:function(e){e=e.replace(" ","");if(!/\w+/.test(e)){this.colorbox("300px","Enter a valid IP or domain","Please enter a valid IP address or domain name for your whois lookup.");return}var t=this;jQuery("#whoisbutton").attr("disabled","disabled");jQuery("#whoisbutton").attr("value","Loading...");this.ajax("wordfence_whois",{val:e},function(e){jQuery("#whoisbutton").removeAttr("disabled");jQuery("#whoisbutton").attr("value","Look up IP or Domain");e.ok&&t.completeWhois(e)})},completeWhois:function(e){if(e.ok&&e.result&&e.result.rawdata&&e.result.rawdata.length>0){var t="";for(var n=0;n<e.result.rawdata.length;n++){e.result.rawdata[n]=e.result.rawdata[n].replace(/([^\s\t\r\n:;]+@[^\s\t\r\n:;\.]+\.[^\s\t\r\n:;]+)/,'<a href="mailto:$1">$1</a>');e.result.rawdata[n]=e.result.rawdata[n].replace(/(https?:\/\/[^\/]+[^\s\r\n\t]+)/,'<a target="_blank" href="$1">$1</a>');var r="";this.getQueryParam("wfnetworkblock")&&(r=' style="color: #F00;"');var i=this;function s(e,t,n,s){var o=t.split(/\s*\-\s*/),u=i.inet_aton(o[0]),a=i.inet_aton(o[1]),f=a-u+1;return'<a href="admin.php?page=WordfenceRangeBlocking&wfBlockRange='+t+'"'+r+">"+t+" [<strong>"+f+"</strong> addresses in this network. Click to block this network]</a>"}e.result.rawdata[n]=e.result.rawdata[n].replace(/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3} - \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/,s);t+=e.result.rawdata[n]+"<br />"}jQuery("#wfrawhtml").html(t)}else jQuery("#wfrawhtml").html('<span style="color: #F00;">Sorry, but no data for that IP or domain was found.</span>')},blockIPUARange:function(e,t,n){if(!/\w+/.test(n)){this.colorbox("300px","Please specify a reason","You forgot to include a reason you're blocking this IP range. We ask you to include this for your own record keeping.");return}e=e.replace(/ /g,"");if(e&&!/^\d+\.\d+\.\d+\.\d+\-\d+\.\d+\.\d+\.\d+$/.test(e)){this.colorbox("300px","Specify a valid IP range",'Please specify a valid IP address range in the form of "1.2.3.4 - 1.2.3.5" without quotes. Make sure the dash between the IP addresses in a normal dash (a minus sign on your keyboard) and not another character that looks like a dash.');return}if(!/\w+/.test(e)&&!/\w+/.test(t)){this.colorbox("300px","Specify an IP range or Browser pattern","Please specify either an IP address range or a web browser pattern to match.");return}var r=this;this.ajax("wordfence_blockIPUARange",{ipRange:e,uaRange:t,reason:n},function(e){if(e.ok){r.loadBlockRanges();return}})},unblockRange:function(e){var t=this;this.ajax("wordfence_unblockRange",{id:e},function(e){t.loadBlockRanges()})},blockIP:function(e,t){var n=this;this.ajax("wordfence_blockIP",{IP:e,reason:t},function(e){if(e.errorMsg)return;n.reloadActivities()})},blockIPTwo:function(e,t,n){var r=this;this.ajax("wordfence_blockIP",{IP:e,reason:t,perm:n?"1":"0"},function(e){if(e.errorMsg)return;r.staticTabChanged()})},unlockOutIP:function(e){var t=this;this.ajax("wordfence_unlockOutIP",{IP:e},function(e){t.staticTabChanged
()})},unblockIP:function(e){var t=this;this.ajax("wordfence_unblockIP",{IP:e},function(e){t.reloadActivities()})},unblockIPTwo:function(e){var t=this;this.ajax("wordfence_unblockIP",{IP:e},function(e){t.staticTabChanged()})},permBlockIP:function(e){var t=this;this.ajax("wordfence_permBlockIP",{IP:e},function(e){t.staticTabChanged()})},makeElemID:function(){return"wfElemGen"+this.elementGeneratorIter++},pulse:function(e){jQuery(e).fadeIn(function(){setTimeout(function(){jQuery(e).fadeOut()},2e3)})},saveConfig:function(){var e=jQuery("#wfConfigForm").serialize(),t=this;jQuery(".wfSavedMsg").hide();jQuery(".wfAjax24").show();this.ajax("wordfence_saveConfig",e,function(e){jQuery(".wfAjax24").hide();if(e.ok){if(e.paidKeyMsg){t.colorbox("400px","Congratulations! You have been upgraded to Premium Scanning.","You have upgraded to a Premium API key. Once this page reloads, you can choose which premium scanning options you would like to enable and then click save. Click the button below to reload this page now.<br /><br /><center><input type='button' name='wfReload' value='Reload page and enable Premium options' onclick='window.location.reload(true);' /></center>");return}if(e["reload"]=="reload"||WFAD.reloadConfigPage){t.colorbox("400px","Please reload this page","You selected a config option that requires a page reload. Click the button below to reload this page to update the menu.<br /><br /><center><input type='button' name='wfReload' value='Reload page' onclick='window.location.reload(true);' /></center>");return}t.pulse(".wfSavedMsg")}else{if(e.errorMsg)return;t.colorbox("400px","An error occurred","We encountered an error trying to save your changes.")}})},changeSecurityLevel:function(){var e=jQuery("#securityLevel").val();for(var t in WFSLevels[e].checkboxes)t!="liveTraf_ignorePublishers"&&jQuery("#"+t).prop("checked",WFSLevels[e].checkboxes[t]);for(var t in WFSLevels[e].otherParams)/^(?:apiKey|securityLevel|alertEmails|liveTraf_ignoreUsers|liveTraf_ignoreIPs|liveTraf_ignoreUA|liveTraf_hitsMaxSize|maxMem|maxExecutionTime|actUpdateInterval)$/.test(t)||jQuery("#"+t).val(WFSLevels[e].otherParams[t])},clearAllBlocked:function(e){if(e=="blocked")body="Are you sure you want to clear all blocked IP addresses and allow visitors from those addresses to access the site again?";else{if(e!="locked")return;body="Are you sure you want to clear all locked IP addresses and allow visitors from those addresses to sign in again?"}this.colorbox("450px","Please confirm",body+'<br /><br /><center><input type="button" name="but1" value="Cancel" onclick="jQuery.colorbox.close();" />&nbsp;&nbsp;&nbsp;'+'<input type="button" name="but2" value="Yes I\'m sure" onclick="jQuery.colorbox.close(); WFAD.confirmClearAllBlocked(\''+e+"');\"><br />")},confirmClearAllBlocked:function(e){var t=this;this.ajax("wordfence_clearAllBlocked",{op:e},function(e){t.staticTabChanged()})},setOwnCountry:function(e){this.ownCountry=(e+"").toUpperCase()},loadBlockedCountries:function(e){var t=e.split(",");for(var n=0;n<t.length;n++)jQuery("#wfCountryCheckbox_"+t[n]).prop("checked",!0)},saveCountryBlocking:function(){var e=jQuery("#wfBlockAction").val(),t=jQuery("#wfRedirURL").val(),n=jQuery("#wfBypassRedirURL").val(),r=jQuery("#wfBypassRedirDest").val(),i=jQuery("#wfBypassViewURL").val();if(e=="redir"&&!/^https?:\/\/[^\/]+/i.test(t)){this.colorbox("400px","Please enter a URL for redirection","You have chosen to redirect blocked countries to a specific page. You need to enter a URL in the text box provided that starts with http:// or https://");return}if(n||r){if(!n||!r){this.colorbox("400px","Missing data from form","If you want to set up a URL that will bypass country blocking, you must enter a URL that a visitor can hit and the destination they will be redirected to. You have only entered one of these components. Please enter both.");return}if(n==r){this.colorbox("400px","URLs are the same","The URL that a user hits to bypass country blocking and the URL they are redirected to are the same. This would cause a circular redirect. Please fix this.");return}}if(n&&!/^(?:\/|http:\/\/)/.test(n)){this.invalidCountryURLMsg(n);return}if(r&&!/^(?:\/|http:\/\/)/.test(r)){this.invalidCountryURLMsg(r);return}if(i&&!/^(?:\/|http:\/\/)/.test(i)){this.invalidCountryURLMsg(i);return}var s=[],o=!1,u=this;jQuery(".wfCountryCheckbox").each(function(e,t){if(jQuery(t).is(":checked")){var n=jQuery(t).val();s.push(n);n==u.ownCountry&&(o=!0)}});var a=s.join(",");this.countryCodesToSave=a;o?this.colorbox("400px","Please confirm blocking yourself","You are about to block your own country. This could lead to you being locked out. Please make sure that your user profile on this machine has a current and valid email address and make sure you know what it is. That way if you are locked out, you can send yourself an unlock email. If you're sure you want to block your own country, click 'Confirm' below, otherwise click 'Cancel'.<br />"+'<input type="button" name="but1" value="Confirm" onclick="jQuery.colorbox.close(); WFAD.confirmSaveCountryBlocking();" />&nbsp;<input type="button" name="but1" value="Cancel" onclick="jQuery.colorbox.close();" />'):this.confirmSaveCountryBlocking()},invalidCountryURLMsg:function(e){this.colorbox("400px","Invalid URL","URL's that you provide for bypassing country blocking must start with '/' or 'http://' without quotes. The URL that is invalid is: "+e);return},confirmSaveCountryBlocking:function(){var e=jQuery("#wfBlockAction").val(),t=jQuery("#wfRedirURL").val(),n=jQuery("#wfLoggedInBlocked").is(":checked")?"1":"0",r=jQuery("#wfLoginFormBlocked").is(":checked")?"1":"0",i=jQuery("#wfBypassRedirURL").val(),s=jQuery("#wfBypassRedirDest").val(),o=jQuery("#wfBypassViewURL").val();jQuery(".wfAjax24").show();var u=this;this.ajax("wordfence_saveCountryBlocking",{blockAction:e,redirURL:t,loggedInBlocked:n,loginFormBlocked:r,bypassRedirURL:i,bypassRedirDest:s,bypassViewURL:o,codes:this.countryCodesToSave},function(e){jQuery(".wfAjax24").hide();u.pulse(".wfSavedMsg")})},paidUsersOnly:function(e){var t=jQuery("#paidWrap").position(),n=jQuery("#paidWrap").width(),r=jQuery("#paidWrap").height();jQuery('<div style="position: absolute; left: '+t.left+"px; top: "+t.top+"px; background-color: #FFF; width: "+n+"px; height: "+r+'px;"><div class="paidInnerMsg">'+e+' <a href="https://www.wordfence.com/wordfence-signup/" target="_blank">Click here to upgrade and gain access to this feature.</div></div>').insertAfter("#paidWrap").fadeTo(1e4,.7)},sched_modeChange:function(){var e=this;jQuery("#schedMode").val()=="auto"?jQuery(".wfSchedCheckbox").attr("disabled",!0):jQuery(".wfSchedCheckbox").attr("disabled",!1)},sched_shortcut:function(e){if(jQuery("#schedMode").val()=="auto"){this.colorbox("400px","Change the scan mode","You need to change the scan mode to manually scheduled scans if you want to select scan times.");return}jQuery(".wfSchedCheckbox").prop("checked",!1);if(this.schedStartHour===!1)this.schedStartHour=Math.floor(Math.random()*24);else{this.schedStartHour++;this.schedStartHour>23&&(this.schedStartHour=0)}if(e=="onceDaily")for(var t=0;t<=6;t++)jQuery("#wfSchedDay_"+t+"_"+this.schedStartHour).attr("checked",!0);else if(e=="twiceDaily"){var n=this.schedStartHour+12;n>=24&&(n-=24);for(var t=0;t<=6;t++){jQuery("#wfSchedDay_"+t+"_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_"+t+"_"+n).attr("checked",!0)}}else if(e=="oddDaysWE"){var r=Math.floor(Math.random());jQuery("#wfSchedDay_1_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_3_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_5_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_6_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_0_"+this.schedStartHour).attr("checked",!0)}else if(e=="weekends"){var r=Math.floor(Math.random());jQuery("#wfSchedDay_6_"+this.schedStartHour).attr("checked",!0);jQuery("#wfSchedDay_0_"+this.schedStartHour).attr("checked",!0)}else if(e=="every6hours")for(var t=0;t<=6;t++)for(var i=this.schedStartHour;i<this.schedStartHour+24;i+=6){var s=i;s>=24&&(s-=24);jQuery("#wfSchedDay_"+t+"_"+s).attr("checked",!0)}},sched_save:function(){var e=jQuery("#schedMode").val(),t=[];for(var n=0;n<=6;n++){var r=[];for(var i=0;i<=23;i++){var s="#wfSchedDay_"+n+"_"+i;r[i]=jQuery(s).is(":checked")?"1":"0"}t[n]=r.join(",")}scheduleTxt=t.join("|");var o=this;this.ajax("wordfence_saveScanSchedule",{schedMode:e,schedTxt:scheduleTxt},function(e){jQuery("#wfScanStartTime").html(e.nextStart);jQuery(".wfAjax24").hide();o.pulse(".wfSaveMsg")})},twoFacStatus:function(e){jQuery("#wfTwoFacMsg").html(e);jQuery("#wfTwoFacMsg").fadeIn(function(){setTimeout(function(){jQuery("#wfTwoFacMsg").fadeOut()},2e3)})},addTwoFactor:function(e,t){var n=this;this.ajax("wordfence_addTwoFactor",{username:e,phone:t},function(e){if(e.ok){n.twoFacStatus("User added! Check the user's phone to get the activation code.");jQuery('<div id="twoFacCont_'+e.userID+'">'+jQuery("#wfTwoFacUserTmpl").tmpl(e).html()+"</div>").prependTo(jQuery("#wfTwoFacUsers"))}})},twoFacActivate:function(e,t){var n=this;this.ajax("wordfence_twoFacActivate",{userID:e,code:t},function(e){if(e.ok){jQuery("#twoFacCont_"+e.userID).html(jQuery("#wfTwoFacUserTmpl").tmpl(e));n.twoFacStatus("Cellphone Sign-in activated for user.")}})},delTwoFac:function(e){this.ajax("wordfence_twoFacDel",{userID:e},function(e){e.ok&&jQuery("#twoFacCont_"+e.userID).fadeOut(function(){jQuery(this).remove()})})},loadTwoFactor:function(){this.ajax("wordfence_loadTwoFactor",{},function(e){if(e.users&&e.users.length>0)for(var t=0;t<e.users.length;t++)jQuery('<div id="twoFacCont_'+e.users[t].userID+'">'+jQuery("#wfTwoFacUserTmpl").tmpl(e.users[t]).html()+0/0).appendTo(jQuery("#wfTwoFacUsers"))})},getQueryParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t),r=n.exec(window.location.search);return r==null?"":decodeURIComponent(r[1].replace(/\+/g," "))},inet_aton:function(e){var t=e.split(".");return((+t[0]*256+ +t[1])*256+ +t[2])*256+ +t[3]},inet_ntoa:function(e){var t=e%256;for(var n=3;n>0;n--){e=Math.floor(e/256);t=e%256+"."+t}return t}};window.WFAD=window.wordfenceAdmin}jQuery(function(){wordfenceAdmin.init()});