jQuery(document).ready(function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m=110,g=e("body").css("overflow"),y=e("html").css("overflow"),b=85,w="";if(window.innerWidth<=760){m=Math.round(window.innerWidth/760*110);m<40&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&(m=0)}var E=function(e){switch(e.which){case 38:e.preventDefault();i.scrollTop(i.scrollTop()-100);break;case 40:e.preventDefault();i.scrollTop(i.scrollTop()+100);break;case 39:e.preventDefault();r.jp_carousel("clearCommentTextAreaValue");r.jp_carousel("next");break;case 37:case 8:e.preventDefault();r.jp_carousel("clearCommentTextAreaValue");r.jp_carousel("previous");break;case 27:e.preventDefault();r.jp_carousel("clearCommentTextAreaValue");i.jp_carousel("close");break;default:}},S=function(e){clearTimeout(c);c=setTimeout(function(){r.jp_carousel("slides").jp_carousel("fitSlide",!0);r.jp_carousel("fitInfo",!0).jp_carousel("fitMeta",!0)},200)},x=function(a){if(!t){t=e("<div></div>").addClass("jp-carousel-overlay").css({position:"absolute",top:0,right:0,bottom:0,left:0});var c='<a class="jp-carousel-commentlink" href="#">'+jetpackCarouselStrings.comment+"</a>";1==jetpackCarouselStrings.is_logged_in;c=e('<div class="jp-carousel-buttons">'+c+"</div>");l=e("<h2></h2>");p=e('<div class="jp-carousel-photo-info"></div>').append(l);imageMeta=e("<div></div>").addClass("jp-carousel-image-meta").css({"float":"right","margin-top":"20px",width:"250px"});imageMeta.append(c).append("<ul class='jp-carousel-image-exif' style='display:none;'></ul>").append("<a class='jp-carousel-image-download' style='display:none;'></a>").append("<div class='jp-carousel-image-map' style='display:none;'></div>");titleAndDescription=e("<div></div>").addClass("jp-carousel-titleanddesc").css({width:"100%","margin-top":imageMeta.css("margin-top")});var h='<div id="jp-carousel-comment-form-container">';if(jetpackCarouselStrings.local_comments_commenting_as&&jetpackCarouselStrings.local_comments_commenting_as.length)if(1!=jetpackCarouselStrings.is_logged_in&&1==jetpackCarouselStrings.comment_registration)h+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+"</div>";else{h+='<form id="jp-carousel-comment-form">';h+='<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="'+jetpackCarouselStrings.write_comment+'"></textarea>';h+='<div id="jp-carousel-comment-form-submit-and-info-wrapper">';h+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+"</div>";h+='<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="'+jetpackCarouselStrings.post_comment+'" />';h+='<span id="jp-carousel-comment-form-spinner">&nbsp;</span>';h+='<div id="jp-carousel-comment-post-results"></div>';h+="</div>";h+="</form>"}h+="</div>";commentForm=e(h).css({width:"100%","margin-top":"20px",color:"#999"});n=e("<div></div>").addClass("jp-carousel-comments").css({width:"100%",bottom:"10px","margin-top":"20px"});commentsLoading=e('<div id="jp-carousel-comments-loading"><span>'+jetpackCarouselStrings.loading_comments+"</span></div>").css({width:"100%",bottom:"10px","margin-top":"20px"});leftWidth=e(window).width()-m*2-(imageMeta.width()+40);leftWidth+="px";leftColWrapper=e("<div></div>").addClass("jp-carousel-left-column-wrapper").css({width:Math.floor(leftWidth)}).append(titleAndDescription).append(commentForm).append(n).append(commentsLoading);fadeaway=e("<div></div>").addClass("jp-carousel-fadeaway");u=e("<div></div>").addClass("jp-carousel-info").css({top:Math.floor(e(window).height()/100*b),left:m,right:m}).append(p).append(imageMeta);if(window.innerWidth<=760){p.remove().insertAfter(titleAndDescription);u.prepend(leftColWrapper)}else u.append(leftColWrapper);targetBottomPos=e(window).height()-parseInt(u.css("top"),10)+"px";s=e("<div><span></span></div>").addClass("jp-carousel-next-button").css({right:"15px"});o=e("<div><span></span></div>").addClass("jp-carousel-previous-button").css({left:0});s.add(o).css({position:"fixed",top:"40px",bottom:targetBottomPos,width:m});r=e("<div></div>").addClass("jp-carousel").css({position:"absolute",top:0,bottom:targetBottomPos,left:0,right:0});d=e('<div class="jp-carousel-close-hint"><span>&times;</span></div>').css({position:"fixed"});i=e("<div></div>").addClass("jp-carousel-wrap").addClass("jp-carousel-transitions");"white"==jetpackCarouselStrings.background_color&&i.addClass("jp-carousel-light");i.css({position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":2147483647,"overflow-x":"hidden","overflow-y":"auto",direction:"ltr"}).hide().append(t).append(r).append(fadeaway).append(u).append(s).append(o).append(d).appendTo(e("body")).click(function(t){var n=e(t.target),s=n.parents("div.jp-carousel-wrap"),o=s.data("carousel-extra"),a=s.find("div.selected"),f=a.data("attachment-id");o=o||[];if(n.is(r)||n.parents().add(n).is(d))i.jp_carousel("close");else if(n.hasClass("jp-carousel-commentlink")){t.preventDefault();t.stopPropagation();e(window).unbind("keydown",E);i.animate({scrollTop:parseInt(u.position().top,10)},"fast");e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast");e("#jp-carousel-comment-form-comment-field").focus()}else if(n.hasClass("jp-carousel-comment-login")){var l=jetpackCarouselStrings.login_url+"%23jp-carousel-"+f;window.location.href=l}else if(n.parents("#jp-carousel-comment-form-container").length){var c=e("#jp-carousel-comment-form-comment-field").blur(function(){e(window).bind("keydown",E)}).focus(function(){e(window).unbind("keydown",E)}),h=e("#jp-carousel-comment-form-email-field").blur(function(){e(window).bind("keydown",E)}).focus(function(){e(window).unbind("keydown",E)}),p=e("#jp-carousel-comment-form-author-field").blur(function(){e(window).bind("keydown",E)}).focus(function(){e(window).unbind("keydown",E)}),v=e("#jp-carousel-comment-form-url-field").blur(function(){e(window).bind("keydown",E)}).focus(function(){e(window).unbind("keydown",E)});if(c&&c.attr("id")==n.attr("id")){e(window).unbind("keydown",E);e("#jp-carousel-comment-form-submit-and-info-wrapper").slideDown("fast")}else if(n.is('input[type="submit"]')){t.preventDefault();t.stopPropagation();e("#jp-carousel-comment-form-spinner").spin("small","white");var m={action:"post_attachment_comment",nonce:jetpackCarouselStrings.nonce,blog_id:o.blog_id,id:f,comment:c.val()};if(!m.comment.length){r.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.no_comment_text});return}if(1!=jetpackCarouselStrings.is_logged_in){m.email=h.val();m.author=p.val();m.url=v.val();if(1==jetpackCarouselStrings.require_name_email){if(!m.email.length||!m.email.match("@")){r.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-email-field",error:jetpackCarouselStrings.no_comment_email});return}if(!m.author.length){r.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-author-field",error:jetpackCarouselStrings.no_comment_author});return}}}e.ajax({type:"POST",url:jetpackCarouselStrings.ajaxurl,data:m,dataType:"json",success:function(t,n,i){"approved"==t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_approved+"</span>").slideDown("fast"):"unapproved"==t.comment_status?e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_unapproved+"</span>").slideDown("fast"):e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+jetpackCarouselStrings.comment_post_error+"</span>").slideDown("fast");r.jp_carousel("clearCommentTextAreaValue");r.jp_carousel("getComments",{attachment_id:f,offset:0,clear:!0});e("#jp-carousel-comment-form-button-submit").val(jetpackCarouselStrings.post_comment);e("#jp-carousel-comment-form-spinner").spin(!1)},error:function(e,t,n){r.jp_carousel("postCommentError",{field:"jp-carousel-comment-form-comment-field",error:jetpackCarouselStrings.comment_post_error});return}})}}else n.parents(".jp-carousel-info").length||i.jp_carousel("next")}).bind("jp_carousel.afterOpen",function(){e(window).bind("keydown",E);e(window).bind("resize",S);r.opened=!0;S()}).bind("jp_carousel.beforeClose",function(){var t=e(window).scrollTop();e(window).unbind("keydown",E);e(window).unbind("resize",S);e(window).scrollTop(t)}).bind("jp_carousel.afterClose",function(){if(history.pushState)history.pushState("",document.title,window.location.pathname+window.location.search);else{w="";window.location.hash=""}r.opened=!1}).on("transitionend.jp-carousel ",".jp-carousel-slide",function(t){if("transform"==t.originalEvent.propertyName){var n=(Date.now()-f)/1e3/t.originalEvent.elapsedTime;i.off("transitionend.jp-carousel");n>=2&&e(".jp-carousel-transitions").removeClass("jp-carousel-transitions")}});e(".jp-carousel-wrap").touchwipe({wipeLeft:function(e){e.preventDefault();r.jp_carousel("next")},wipeRight:function(e){e.preventDefault();r.jp_carousel("previous")},preventDefaultEvents:!1});e(".jetpack-likes-widget-unloaded").each(function(){jetpackLikesWidgetQueue.push(this.id)});s.add(o).click(function(e){e.preventDefault();e.stopPropagation();s.is(this)?r.jp_carousel("next"):r.jp_carousel("previous")})}},T={testForData:function(t){t=e(t);return!t.length||undefined==t.data("carousel-extra")?!1:!0},testIfOpened:function(){return"undefined"!=typeof r&&"undefined"!=typeof r.opened&&1==r.opened?!0:!1},open:function(t){var n={items_selector:".gallery-item [data-attachment-id], .tiled-gallery-item [data-attachment-id]",start_index:0},s=e(this).data("carousel-extra");if(!s)return;x(s);if(r.jp_carousel("testIfOpened"))return;g=e("body").css("overflow");e("body").css("overflow","hidden");y=e("html").css("overflow");e("html").css("overflow","hidden");jQuery(".slim-likes-widget").find("iframe").css("display","inline-block").css("width","60px");i.data("carousel-extra",s);return this.each(function(){var s=e(this);t&&e.extend(n,t);-1==n.start_index&&(n.start_index=0);i.trigger("jp_carousel.beforeOpen").fadeIn("fast",function(){i.trigger("jp_carousel.afterOpen");r.jp_carousel("initSlides",s.find(n.items_selector),n.start_index).jp_carousel("start",n.start_index)});r.html("")})},start:function(e){var t=this.jp_carousel("slides"),n=t.eq(e);0===n.length&&(n=t.eq(0));r.jp_carousel("selectSlide",n,!1);return this},close:function(){e("body").css("overflow",g);e("html").css("overflow",y);return i.trigger("jp_carousel.beforeClose").fadeOut("fast",function(){i.trigger("jp_carousel.afterClose")})},next:function(){var e=r.jp_carousel("nextSlide");i.animate({scrollTop:0},"fast");e&&this.jp_carousel("selectSlide",e)},previous:function(){var e=r.jp_carousel("prevSlide");i.animate({scrollTop:0},"fast");e&&this.jp_carousel("selectSlide",e)},resetButtons:function(t){t.data("liked")?e(".jp-carousel-buttons a.jp-carousel-like").addClass("liked").text(jetpackCarouselStrings.unlike):e(".jp-carousel-buttons a.jp-carousel-like").removeClass("liked").text(jetpackCarouselStrings.like)},selectedSlide:function(){return this.find(".selected")},setSlidePosition:function(e){f=Date.now();return this.css({"-webkit-transform":"translate3d("+e+"px,0,0)","-moz-transform":"translate3d("+e+"px,0,0)","-ms-transform":"translate("+e+"px,0)","-o-transform":"translate("+e+"px,0)",transform:"translate3d("+e+"px,0,0)"})},selectSlide:function(t,n){var s=this.find(".selected").removeClass("selected"),o=r.jp_carousel("slides").css({position:"fixed"}),u=e(t).addClass("selected").css({position:"relative"}),a=u.data("attachment-id"),f=r.jp_carousel("prevSlide"),c=r.jp_carousel("nextSlide"),h=e(window).width(),p=f.prev(),d=c.next(),v=r.width(),g=u.width(),y=Math.floor((v-g)*.5),b,E,S,x;r.jp_carousel("loadFullImage",u);l.hide();c.length==0&&o.length<=2?e(".jp-carousel-next-button").hide():e(".jp-carousel-next-button").show();f.length==0&&o.length<=2?e(".jp-carousel-previous-button").hide():e(".jp-carousel-previous-button").show();E="css";S=u.add(f).add(p).add(c).add(d).jp_carousel("loadSlide");o.not(S).hide();u.jp_carousel("setSlidePosition",y).show();r.jp_carousel("fitInfo",n);var T=s.is(u.prevAll())?1:-1;if(1==T){d.is(f)||d.jp_carousel("setSlidePosition",v+c.width()).show();p.is(c)||p.jp_carousel("setSlidePosition",-p.width()-g).show()}else d.is(f)||d.jp_carousel("setSlidePosition",v+g).show();f.jp_carousel("setSlidePosition",Math.floor(-f.width()+m*.75)).show();c.jp_carousel("setSlidePosition",Math.ceil(v-m*.75)).show();r.jp_carousel("resetButtons",u);i.trigger("jp_carousel.selectSlide",[u]);r.jp_carousel("getTitleDesc",{title:u.data("title"),desc:u.data("desc")});r.jp_carousel("loadLikes",a);r.jp_carousel("updateLikesWidgetVisibility",a);c.length>0&&r.jp_carousel("loadLikes",c.data("attachment-id"));f.length>0&&r.jp_carousel("loadLikes",f.data("attachment-id"));var N=u.data("image-meta");r.jp_carousel("updateExif",N);r.jp_carousel("updateFullSizeLink",u);r.jp_carousel("updateMap",N);r.jp_carousel("testCommentsOpened",u.data("comments-opened"));r.jp_carousel("getComments",{attachment_id:a,offset:0,clear:!0});e("#jp-carousel-comment-post-results").slideUp();if(u.data("caption")){e("<div />").text(u.data("caption")).html()==e("<div />").text(u.data("title")).html()&&e(".jp-carousel-titleanddesc-title").fadeOut("fast").empty();e("<div />").text(u.data("caption")).html()==e("<div />").text(u.data("desc")).html()&&e(".jp-carousel-titleanddesc-desc").fadeOut("fast").empty();l.html(u.data("caption")).fadeIn("slow")}else l.fadeOut("fast").empty();e(c).add(f).each(function(){r.jp_carousel("loadFullImage",e(this))});window.location.hash=w="#jp-carousel-"+a},slides:function(){return this.find(".jp-carousel-slide")},slideDimensions:function(){return{width:e(window).width()-m*2,height:Math.floor(e(window).height()/100*b-60)}},loadSlide:function(){return this.each(function(){var t=e(this);t.find("img").one("load",function(){t.jp_carousel("fitSlide",!1)})})},bestFit:function(){var e=r.jp_carousel("slideDimensions"),t=this.jp_carousel("originalDimensions"),n=t.width/t.height,i=1,s=1;t.width>e.width&&(i=e.width/t.width);t.height>e.height&&(s=e.height/t.height);if(i<s){width=e.width;height=Math.floor(width/n)}else if(s<i){height=e.height;width=Math.floor(height*n)}else{width=t.width;height=t.height}return{width:width,height:height}},fitInfo:function(e){var t=this.jp_carousel("selectedSlide"),n=t.jp_carousel("bestFit");p.css({left:Math.floor((u.width()-n.width)*.5),width:Math.floor(n.width)});return this},fitMeta:function(t){var n={top:Math.floor(e(window).height()/100*b+5)+"px"},r={width:u.width()-(imageMeta.width()+80)+"px"};if(t){u.animate(n);leftColWrapper.animate(r)}else{u.animate(n);leftColWrapper.css(r)}},fitSlide:function(t){return this.each(function(){var t=r.jp_carousel("selectedSlide"),n=e(this),i=n.jp_carousel("bestFit"),s="css",o=r.jp_carousel("slideDimensions");i.left=0;i.top=Math.floor((o.height-i.height)*.5)+40;n[s](i)})},texturize:function(t){t=new String(t);t=t.replace(/'/g,"&#8217;").replace(/&#039;/g,"&#8217;").replace(/[\u2019]/g,"&#8217;");t=t.replace(/"/g,"&#8221;").replace(/&#034;/g,"&#8221;").replace(/&quot;/g,"&#8221;").replace(/[\u201D]/g,"&#8221;");t=t.replace(/([\w]+)=&#[\d]+;(.+?)&#[\d]+;/g,'$1="$2"');return e.trim(t)},initSlides:function(t,n){var i=this.jp_carousel("slideDimensions").width,s=0;t.length<2?e(".jp-carousel-next-button, .jp-carousel-previous-button").hide():e(".jp-carousel-next-button, .jp-carousel-previous-button").show();t.each(function(t){var n=e(this),i=n.data("orig-size")||"",s=r.jp_carousel("slideDimensions"),o=i.split(",");i={width:parseInt(o[0],10),height:parseInt(o[1],10)},medium_file=n.data("medium-file")||"",large_file=n.data("large-file")||"";src=n.data("orig-file");src=r.jp_carousel("selectBestImageSize",{orig_file:src,orig_width:i.width,orig_height:i.height,max_width:s.width,max_height:s.height,medium_file:medium_file,large_file:large_file});e(this).data("gallery-src",src)});0!==n&&(e("<img/>")[0].src=e(t[n]).data("gallery-src"));var o=t.first().closest(".tiled-gallery.type-rectangular").length>0;t.each(function(t){var i=e(this),s=i.data("attachment-id")||0,u=i.data("comments-opened")||0,a=i.data("image-meta")||{},f=i.data("orig-size")||"",l={width:i[0].naturalWidth,height:i[0].naturalHeight},c=i.data("image-title")||"",h=i.data("image-description")||"",p=i.parents("dl").find("dd.gallery-caption").html()||"",d=i.data("gallery-src")||"",v=i.data("medium-file")||"",m=i.data("large-file")||"",g=i.data("orig-file")||"",y=i.parents("div.tiled-gallery-item").find("div.tiled-gallery-caption").html();y&&(p=y);if(s&&f.length){c=r.jp_carousel("texturize",c);h=r.jp_carousel("texturize",h);p=r.jp_carousel("texturize",p);var b=e("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7").css("width","100%").css("height","100%"),w=e('<div class="jp-carousel-slide"></div>').hide().css({left:t<n?-1e3:r.width()}).append(b).appendTo(r).data("src",d).data("title",c).data("desc",h).data("caption",p).data("attachment-id",s).data("permalink",i.parents("a").attr("href")).data("orig-size",f).data("comments-opened",u).data("image-meta",a).data("medium-file",v).data("large-file",m).data("orig-file",g).data("thumb-size",l);o&&w.data("preview-image",i.attr("src")).css({"background-image":'url("'+i.attr("src")+'")',"background-size":"100% 100%","background-position":"center center"});w.jp_carousel("fitSlide",!1)}});return this},selectBestImageSize:function(e){"object"!=typeof e&&(e={});if("undefined"==typeof e.orig_file)return"";if("undefined"==typeof e.orig_width||"undefined"==typeof e.max_width)return e.orig_file;if("undefined"==typeof e.medium_file||"undefined"==typeof e.large_file)return e.orig_file;var t=e.medium_file.replace(/-([\d]+x[\d]+)\..+$/,"$1"),n=t!=e.medium_file?t.split("x"):[e.orig_width,0],r=parseInt(n[0],10),i=parseInt(n[1],10),s=e.large_file.replace(/-([\d]+x[\d]+)\..+$/,"$1"),o=s!=e.large_file?s.split("x"):[e.orig_width,0],u=parseInt(o[0],10),a=parseInt(o[1],10);if("undefined"!=typeof window.devicePixelRatio&&window.devicePixelRatio>1){e.max_width=e.max_width*window.devicePixelRatio;e.max_height=e.max_height*window.devicePixelRatio}return u>=e.max_width||a>=e.max_height?e.large_file:r>=e.max_width||i>=e.max_height?e.medium_file:e.orig_file},originalDimensions:function(){var t=e(this).data("orig-size").split(",");return{width:parseInt(t[0],10),height:parseInt(t[1],10)}},format:function(e){"object"!=typeof e&&(e={});if(!e.text||"undefined"==typeof e.text)return;return!e.replacements||"undefined"==typeof e.replacements?e.text:e.text.replace(/{(\d+)}/g,function(t,n){return typeof e.replacements[n]!="undefined"?e.replacements[n]:t})},shutterSpeed:function(e){if(e>=1)return Math.round(e)+"s";var t=1,n=1,r=1,i=1e3;while(t!=e&&i-->0){if(t<e)n+=1;else{r+=1;n=parseInt(e*r,10)}t=n/r}if(n>1){r=Math.round(r/n);n=1}return r<=1?"1s":n+"/"+r+"s"},parseTitleDesc:function(t){if(!t.match(" ")&&t.match("_"))return"";var n=e(["CIMG","DSC_","DSCF","DSCN","DUW","GEDC","IMG","JD","MGP","PICT","Imagen","Foto","DSC","Scan","SANY","SAM","Screen Shot [0-9]+"]).each(function(e,n){regex=new RegExp("^"+n);if(regex.test(t)){t="";return}});return t},getTitleDesc:function(t){var n="",i="",s="",o,u;o=e("div.jp-carousel-titleanddesc","div.jp-carousel-wrap");o.hide();n=r.jp_carousel("parseTitleDesc",t.title)||"";i=r.jp_carousel("parseTitleDesc",t.desc)||"";if(n.length||i.length){e("<div />").text(n).html()==e("<div />").text(i).html()&&(n="");s=n.length?'<div class="jp-carousel-titleanddesc-title">'+n+"</div>":"";s+=i.length?'<div class="jp-carousel-titleanddesc-desc">'+i+"</div>":"";o.html(s).fadeIn("slow")}e("div#jp-carousel-comment-form-container").css("margin-top","20px");e("div#jp-carousel-comments-loading").css("margin-top","20px")},updateLikesWidgetVisibility:function(t){if("undefined"==typeof jetpackLikesWidgetQueue)return;e(".jp-carousel-buttons .jetpack-likes-widget-wrapper").css("display","none").each(function(){var n=e(this);if(n.attr("data-attachment-id")==t){n.css("display","inline-block");return!1}})},loadLikes:function(t){var n=e(".jp-carousel-wrap").data("carousel-extra"),r=n.likes_blog_id;if(e("#like-post-wrapper-"+r+"-"+t).length==0){var i="http",s="http://wordpress.com";if(n.permalink.length){var i=n.permalink.split(":")[0];i!="http"&&i!="https"&&(i="http");var o=n.permalink.split("/");o.length>=2&&(s=i+"://"+o[2])}var u=i+"://widgets.wp.com/likes/#blog_id="+encodeURIComponent(r)+"&post_id="+encodeURIComponent(t)+"&slim=1&origin="+encodeURIComponent(s);"en"!==jetpackCarouselStrings.lang&&(u+="&lang="+encodeURIComponent(jetpackCarouselStrings.lang));var a=e("<iframe class='post-likes-widget jetpack-likes-widget jetpack-resizeable'></iframe>").attr("name","like-post-frame-"+r+"-"+t).attr("src",u).css("display","inline-block"),f=e("<div/>").addClass("jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded slim-likes-widget").attr("id","like-post-wrapper-"+r+"-"+t).attr("data-src",u).attr("data-name","like-post-frame-"+r+"-"+t).attr("data-attachment-id",t).css("display","none").css("vertical-align","middle").append(a).append("<div class='post-likes-widget-placeholder'></div>");e(".jp-carousel-buttons").append(f)}},updateExif:function(t){if(!t||1!=jetpackCarouselStrings.display_exif)return!1;var n=e("<ul class='jp-carousel-image-exif'></ul>");e.each(t,function(t,i){if(0===parseFloat(i)||!i.length||-1===e.inArray(t,["camera","aperture","shutter_speed","focal_length"]))return;switch(t){case"focal_length":i+="mm";break;case"shutter_speed":i=r.jp_carousel("shutterSpeed",i);break;case"aperture":i="f/"+i}n.append("<li><h5>"+jetpackCarouselStrings[t]+"</h5>"+i+"</li>")});e("div.jp-carousel-image-meta ul.jp-carousel-image-exif").replaceWith(n)},updateFullSizeLink:function(t){if(!t||!t.data)return!1;var n=t.data("orig-file").replace(/\?.+$/,""),i=t.data("orig-size").split(","),s=e("<a>"+r.jp_carousel("format",{text:jetpackCarouselStrings.download_original,replacements:i})+"</a>").addClass("jp-carousel-image-download").attr("href",n).attr("target","_blank");e("div.jp-carousel-image-meta a.jp-carousel-image-download").replaceWith(s)},updateMap:function(t){if(!t.latitude||!t.longitude||1!=jetpackCarouselStrings.display_geo)return;var n=t.latitude,r=t.longitude,i=e("div.jp-carousel-image-meta","div.jp-carousel-wrap"),s=e("<div></div>"),o="&scale=2&style=feature:all|element:all|invert_lightness:true|hue:0x0077FF|saturation:-50|lightness:-5|gamma:0.91";s.addClass("jp-carousel-image-map").html('<img width="154" height="154" src="https://maps.googleapis.com/maps/api/staticmap?							center='+n+","+r+"&							zoom=8&							size=154x154&							sensor=false&							markers=size:medium%7Ccolor:blue%7C"+n+","+r+o+'" class="gmap-main" />													<div class="gmap-topright"><div class="imgclip"><img width="175" height="154" src="https://maps.googleapis.com/maps/api/staticmap?							center='+n+","+r+"&							zoom=3&							size=175x154&							sensor=false&							markers=size:small%7Ccolor:blue%7C"+n+","+r+o+'"c /></div></div>													').prependTo(i)},testCommentsOpened:function(t){if(1==parseInt(t,10)){e(".jp-carousel-buttons").fadeIn("fast");commentForm.fadeIn("fast")}else{e(".jp-carousel-buttons").fadeOut("fast");commentForm.fadeOut("fast")}},getComments:function(t){clearInterval(v);if("object"!=typeof t)return;if("undefined"==typeof t.attachment_id||!t.attachment_id)return;if(!t.offset||"undefined"==typeof t.offset||t.offset<1)t.offset=0;var n=e(".jp-carousel-comments"),i=e("#jp-carousel-comments-loading").show();t.clear&&n.hide().empty();e.ajax({type:"GET",url:jetpackCarouselStrings.ajaxurl,dataType:"json",data:{action:"get_attachment_comments",nonce:jetpackCarouselStrings.nonce,id:t.attachment_id,offset:t.offset},success:function(s,o,u){t.clear&&n.fadeOut("fast").empty();e(s).each(function(){var i=e("<div></div>").addClass("jp-carousel-comment").attr("id","jp-carousel-comment-"+this.id).html('<div class="comment-gravatar">'+this.gravatar_markup+"</div>"+'<div class="comment-author">'+this.author_markup+"</div>"+'<div class="comment-date">'+this.date_gmt+"</div>"+'<div class="comment-content">'+this.content+"</div>");n.append(i);clearInterval(v);v=setInterval(function(){if(e(".jp-carousel-overlay").height()-150<e(".jp-carousel-wrap").scrollTop()+e(window).height()){r.jp_carousel("getComments",{attachment_id:t.attachment_id,offset:t.offset+10,clear:!1});clearInterval(v)}},300)});var a=e(".jp-carousel div.selected");if(a&&a.data&&a.data("attachment-id")!=t.attachment_id){n.fadeOut("fast");n.empty();return}e(".jp-carousel-overlay").height(e(window).height()+titleAndDescription.height()+commentForm.height()+(n.height()>0?n.height():imageMeta.height())+200);n.show();i.hide()},error:function(e,t,r){console.log("Comment get fail...",e,t,r);n.fadeIn("fast");i.fadeOut("fast")}})},postCommentError:function(t){"object"!=typeof t&&(t={});if(!t.field||"undefined"==typeof t.field||!t.error||"undefined"==typeof t.error)return;e("#jp-carousel-comment-post-results").slideUp("fast").html('<span class="jp-carousel-comment-post-error">'+t.error+"</span>").slideDown("fast");e("#jp-carousel-comment-form-spinner").spin(!1)},setCommentIframeSrc:function(t){var n=e("#jp-carousel-comment-iframe");if(n&&n.length){n.attr("src",n.attr("src").replace(/(postid=)\d+/,"$1"+t));n.attr("src",n.attr("src").replace(/(%23.+)?$/,"%23jp-carousel-"+t))}},clearCommentTextAreaValue:function(){var t=e("#jp-carousel-comment-form-comment-field");t&&t.val("")},nextSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return t.length==0||e.length>2&&t.is(e.last())?e.first():t.next()},prevSlide:function(){var e=this.jp_carousel("slides"),t=this.jp_carousel("selectedSlide");return t.length==0||e.length>2&&t.is(e.first())?e.last():t.prev()},loadFullImage:function(t){var n=t.find("img:first");if(!n.data("loaded")){n.on("load.jetpack",function(){n.off("load.jetpack");e(this).closest(".jp-carousel-slide").css("background-image","")});!t.data("preview-image")||t.data("thumb-size")&&t.width()>t.data("thumb-size").width?n.attr("src",n.closest(".jp-carousel-slide").data("src")):n.attr("src",t.data("preview-image"));n.data("loaded",1)}}};e.fn.jp_carousel=function(t){if(T[t])return T[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return T.open.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.jp_carousel")};e(document.body).on("click","div.gallery,div.tiled-gallery",function(t){if(!e(this).jp_carousel("testForData",t.currentTarget))return;if(e(t.target).parent().hasClass("gallery-caption"))return;t.preventDefault();e(this).jp_carousel("open",{start_index:e(this).find(".gallery-item, .tiled-gallery-item").index(e(t.target).parents(".gallery-item, .tiled-gallery-item"))})});e(window).on("hashchange",function(){if(!window.location.hash||!window.location.hash.match(/jp-carousel-(\d+)/))return;if(window.location.hash==w)return;w=window.location.hash;var t=e("div.gallery, div.tiled-gallery"),n=-1,r=window.location.hash.match(/jp-carousel-(\d+)/);if(!e(this).jp_carousel("testForData",t))return;r=parseInt(r[1],10);t.find("img").each(function(t,i){if(r&&e(i).data("attachment-id")==r){n=t;return!1}});n!=-1&&t.jp_carousel("open",{start_index:n})});window.location.hash&&e(window).trigger("hashchange")});(function(e){e.fn.touchwipe=function(t){var n={min_move_x:20,min_move_y:20,wipeLeft:function(e){},wipeRight:function(e){},wipeUp:function(e){},wipeDown:function(e){},preventDefaultEvents:!0};t&&e.extend(n,t);this.each(function(){function i(){this.removeEventListener("touchmove",s);e=null;r=!1}function s(s){n.preventDefaultEvents&&s.preventDefault();if(r){var o=s.touches[0].pageX,u=s.touches[0].pageY,a=e-o,f=t-u;if(Math.abs(a)>=n.min_move_x){i();a>0?n.wipeLeft(s):n.wipeRight(s)}else if(Math.abs(f)>=n.min_move_y){i();f>0?n.wipeDown(s):n.wipeUp(s)}}}function o(n){if(n.touches.length==1){e=n.touches[0].pageX;t=n.touches[0].pageY;r=!0;this.addEventListener("touchmove",s,!1)}}var e,t,r=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",o,!1)});return this}})(jQuery);